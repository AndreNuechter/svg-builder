!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=7)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return d})),n.d(t,"j",(function(){return u})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return f})),n.d(t,"l",(function(){return y})),n.d(t,"k",(function(){return m})),n.d(t,"m",(function(){return g})),n.d(t,"n",(function(){return h})),n.d(t,"o",(function(){return x})),n.d(t,"p",(function(){return j})),n.d(t,"q",(function(){return p})),n.d(t,"s",(function(){return v})),n.d(t,"r",(function(){return b})),n.d(t,"t",(function(){return O}));const r=document.getElementById("arc-cmd-config"),o=document.getElementById("commands"),c=document.getElementsByClassName("control-point"),a=document.getElementById("control-point-container"),i=document.getElementById("download-btn"),s=document.getElementById("drawing-content"),d=document.getElementById("fill-and-stroke"),u=s.children,l=document.getElementById("layer-select"),f=document.getElementsByName("layer-selector"),y=document.getElementById("output-configuration"),m=document.getElementById("modes"),h=document.getElementById("preview"),g=document.getElementById("close-path-toggle"),p=document.getElementById("canvas"),b=document.getElementById("transformations"),v=b.elements,j=v.scale.getElementsByTagName("input"),x=v.rotate.getElementsByTagName("input"),[O]=document.getElementsByName("transform-layer-only")},function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return y})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return m})),n.d(t,"i",(function(){return b})),n.d(t,"j",(function(){return v})),n.d(t,"f",(function(){return h})),n.d(t,"g",(function(){return g})),n.d(t,"h",(function(){return p})),n.d(t,"k",(function(){return j})),n.d(t,"l",(function(){return x})),n.d(t,"m",(function(){return O})),n.d(t,"n",(function(){return w})),n.d(t,"o",(function(){return C})),n.d(t,"p",(function(){return I})),n.d(t,"q",(function(){return E}));var r=n(3),o=n(0),c=n(2);const a=["checked","textContent","data","onpointerdown","onpointerup"],{elements:i}=o.g,{elements:s}=o.l,d=(e,t)=>{Object.entries(t).forEach(([t,n])=>{e[t].value=n})};function u(e,t){const n=E(e.transforms),r=[o.f,o.c],c=[n];if(o.j[t.layerId]){const e=E(t.activeLayer.transforms);r.push(o.j[t.layerId]),c.push(n+e,e)}else c.push(n);r.forEach((e,t)=>e.setAttribute("transform",c[t]))}function l(e){if("object"!=typeof e||null===e)return e;const t=Array.isArray(e)?[]:{};return Object.keys(e).forEach(n=>{t[n]=l(e[n])}),t}function f(e){return t=>y(e.cloneNode(!1),t)}function y(e,t){return Object.keys(t).forEach(n=>{a.includes(n)?e[n]=t[n]:e.setAttribute(n,t[n])}),e}function m(e,t){return n=>{const[r,o]=p(n);y(e,t(r,o))}}function h(e){return e.slice().reverse().find(e=>"A"===e.cmd)}function g(e){return[...i].filter(t=>t.hasAttribute("name")&&t.closest("label").classList.contains("for-"+e)).reduce((e,t)=>Object.assign(e,{[t.name]:t.value}),{})}function p({x:e,y:t}){let n=o.q.createSVGPoint();return Object.assign(n,{x:e,y:t}),n=n.matrixTransform(o.q.children[1].getScreenCTM().inverse()),[n.x,n.y]}function b(e){return e[v(e)]}function v(e){return e.length-1}function j(e){return e.cmd+r.c[e.cmd](e)}function x(e,t){const n=e.activeLayer?h(e.activeLayer.points)||{...t.arcCmdConfig,...e.arcCmdConfig}:t.arcCmdConfig;Object.assign(e.arcCmdConfig,n),Object.entries(n).filter(([e])=>!["cmd","x","y"].includes(e)).forEach(([e,t])=>{const n=o.a.elements[e];n["checkbox"===n.type?"checked":"value"]=t})}function O(e){"path"===e.activeLayer.mode&&(e.cmd=e.activeLayer.points.length?b(e.activeLayer.points).cmd:"M")}function w(e){d(i,e)}function C({outputConfig:e}){d(s,e)}function I(e){Object.entries(e).filter(([e])=>"translate"!==e).forEach(([e,t])=>{c.b[e]?t.forEach((t,n)=>{c.b[e][n].value=t}):o.s[e].value=t})}function E(e){return Object.entries(e).reduce((e,[t,n])=>`${e}${t}(${"object"==typeof n?n.filter(Boolean):n})`,"")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return u}));var r=n(0),o=n(3);const c=Object.freeze(Object.keys(o.c)),a=Object.freeze({scale:r.p,rotate:r.o}),i=Object.freeze({mode:"path",closePath:!1,outputConfig:Object.freeze({width:"320",height:"180","vb-min-x":"0","vb-min-y":"0","vb-width":"0","vb-height":"0",ratio:"xMidYMid","slice-or-meet":"meet","file-format":"svg"}),transforms:Object.freeze({translate:Object.freeze(["0","0"]),scale:Object.freeze(["1","1"]),rotate:Object.freeze(["0","0","0"]),skewX:"0",skewY:"0"}),style:Object.freeze({stroke:"#000","stroke-opacity":"1","stroke-width":"2",fill:"none","fill-opacity":"1"}),arcCmdConfig:Object.freeze({xR:"50",yR:"50",xRot:"0",large:!1,sweep:!1})}),s=e=>e+1,d=e=>e-1,u=Object.freeze({ArrowUp:Object.freeze({prop:1,cb:d}),ArrowDown:Object.freeze({prop:1,cb:s}),ArrowLeft:Object.freeze({prop:0,cb:d}),ArrowRight:Object.freeze({prop:0,cb:s})})},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return d}));const r=({x:e,y:t})=>`${e} ${t}`,o={H:({x:e})=>e,V:({y:e})=>e,Q:({x:e,x1:t,y:n,y1:r})=>`${t} ${r} ${e} ${n}`,C:({x:e,x1:t,x2:n,y:r,y1:o,y2:c})=>`${t} ${o} ${n} ${c} ${e} ${r}`,A:({x:e,xR:t,xRot:n,y:r,yR:o,large:c,sweep:a})=>`${t} ${o} ${n} ${c} ${a} ${e} ${r}`,S:({x:e,x1:t,y:n,y1:r})=>`${t} ${r} ${e} ${n}`,T:r,M:r,L:r},c=(e,t,n,r)=>e<t?n>r?-33:33:0,a=(e,t,n,r)=>{const o=Math.abs(n-e),a=Math.abs(r-t);return{xMin:Math.min(e,n),yMin:Math.min(t,r),yOffset:c(a,o,n,e),xOffset:c(o,a,r,t)}};function i(e){return{xR:e.xR,yR:e.yR,xRot:e.xRot,large:+e.large,sweep:+e.sweep}}function s(e,t,{x:n,y:r}){const{xMin:o,yMin:c,yOffset:i,xOffset:s}=a(e,t,n,r);return{x1:o-s+.25*(Math.max(e,n)-o),y1:c-i+.25*(Math.max(t,r)-c),x2:o-s+.75*(Math.max(e,n)-o),y2:c-i+.75*(Math.max(t,r)-c)}}function d(e,t,{x:n,y:r}){const{xMin:o,yMin:c,yOffset:i,xOffset:s}=a(e,t,n,r);return{x1:o-s+.5*(Math.max(e,n)-o),y1:c-i+.5*(Math.max(t,r)-c)}}},function(e,t,n){"use strict";n.r(t),t.default=window.addEventListener("load",()=>{const e=({target:{parentElement:e}})=>{e.classList.toggle("closed"),e.classList.toggle("open")};[...document.getElementsByClassName("togglable")].forEach(t=>{t.firstElementChild.onclick=e,t.classList.contains("open")||t.classList.contains("closed")||t.classList.add("closed")})},{once:!0})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(0);const c=document.getElementById("coords"),a=e=>{const[t,n]=Object(r.h)(e);c.textContent=`x: ${Math.trunc(t)}, y: ${Math.trunc(n)}`,c.style.left=e.pageX-120+"px",c.style.top=e.pageY-40+"px"};t.default=(o.q.addEventListener("pointermove",a),void o.q.addEventListener("pointerleave",()=>{c.style=null}))},function(e,t,n){"use strict";n.r(t),t.default=(()=>{const{body:e}=document,t=document.getElementById("tabs"),n=[...t.children],r=["drawing","output"],o=()=>{const t=window.location.hash.slice(1),n=r.includes(t)?t:r[0];e.dataset.activeTab=n,document.querySelector(`a[data-tab-name="${n}"]`).click(),n!==t&&(window.location.hash=n)};window.addEventListener("DOMContentLoaded",o,{once:!0}),window.onhashchange=o,t.onclick=({target:t})=>{t.classList.contains("tab")&&(e.dataset.activeTab=t.dataset.tabName,n.forEach(e=>e.classList.remove("active")),t.classList.add("active"))}})()},function(e,t,n){n(8),n(5),n(4),e.exports=n(6)},function(e,t,n){"use strict";n.r(t);n(4),n(5),n(6);var r=n(1);const o="http://www.w3.org/2000/svg",c=(()=>{const e=Object(r.d)(document.createElement("label"),{draggable:!0}),t=Object(r.d)(document.createElement("span"),{contenteditable:!0}),n=Object(r.d)(document.createElement("input"),{type:"radio",name:"layer-selector"});return e.append(t,n),e})(),a={path:document.createElementNS(o,"path"),rect:document.createElementNS(o,"rect"),ellipse:document.createElementNS(o,"ellipse")},i=Object(r.d)(document.createElementNS(o,"circle"),{r:3,class:"control-point"}),s=document.createElement("a"),d=document.createElement("img"),u=document.createElement("canvas");var l=n(0),f=n(2);const y={get viewBox(){return[this.outputConfig["vb-min-x"],this.outputConfig["vb-min-y"],this.outputConfig["vb-width"],this.outputConfig["vb-height"]]}},m=/ data-layer-id="\d+"/g,h=/\s{2,}/g;var g=y;function p(){const{x:e,y:t,width:n,height:o}=l.f.getBBox();Object.assign(y.outputConfig,{"vb-min-x":Math.trunc(e),"vb-min-y":Math.trunc(t),"vb-width":Math.trunc(n),"vb-height":Math.trunc(o)}),x(),Object(r.o)(y),j()}function b(){return`<svg xmlns="http://www.w3.org/2000/svg" \n    width="${y.outputConfig.width}" \n    height="${y.outputConfig.height}" \n    viewBox="${y.viewBox}" \n    preserveAspectRatio="${[y.outputConfig.ratio,y.outputConfig["slice-or-meet"]].join(" ")}">\n    <g transform="${Object(r.q)(y.transforms)}">${l.f.innerHTML}</g></svg>`.replace(m,"").replace(h," ")}function v(){return("data:image/svg+xml,"+b().replace(/"/g,"'")).replace(/#/g,"%23")}function j(){window.localStorage.setItem("drawing",JSON.stringify(y))}function x(){Object(r.d)(l.n.firstElementChild,{width:y.outputConfig.width,height:y.outputConfig.height,viewBox:y.viewBox,preserveAspectRatio:[y.outputConfig.ratio,y.outputConfig["slice-or-meet"]].join(" ")})}var O=n(3);const w=(e,t)=>(n,r)=>({x:Math.min(e,n),y:Math.min(t,r),width:Math.abs(e-n),height:Math.abs(t-r)}),C=(e,t)=>(n,r)=>({rx:Math.abs(e-n),ry:Math.abs(t-r)});var I={rect:E((e,t,n,o)=>{if(t[0])return;const c=l.j[e.layerId];t.push({x:n,y:o}),Object(r.d)(c,t[0]),e.drawingShape=!0,Object.assign(e.shapeStart,{x:n,y:o}),l.q.onpointermove=Object(r.e)(c,w(n,o))},({points:[e]})=>({x:e.x,y:e.y,width:e.width||0,height:e.height||0})),ellipse:E((e,t,n,o)=>{if(t[0])return;const c=l.j[e.layerId];t.push({cx:n,cy:o}),Object(r.d)(c,t[0]),e.drawingShape=!0,Object.assign(e.shapeStart,{x:n,y:o}),l.q.onpointermove=Object(r.e)(c,C(n,o))},({points:[e]})=>({cx:e.cx,cy:e.cy,rx:e.rx||0,ry:e.ry||0})),path:E((e,t,n,o,c,a)=>{const i=Object(r.i)(t);if(i&&n===i.x&&o===i.y)return;t.length||(e.cmd="M"),i&&i.cmd===e.cmd&&["M","V","H"].includes(e.cmd)&&a(t.pop().cmd),t.push({cmd:e.cmd,x:n,y:o});const s=(r=>{switch(r){case"Q":case"S":return Object(O.d)(n,o,t[t.length-2]);case"C":return Object(O.b)(n,o,t[t.length-2]);case"A":return Object(O.a)({...f.c.arcCmdConfig,...e.arcCmdConfig});default:return{}}})(e.cmd);Object.assign(Object(r.i)(t),s),c(e.activeLayer,e.layerId)(Object(r.i)(t),Object(r.j)(t))},({points:e,closePath:t})=>({d:`${e.map(r.k).join("")} ${t?"Z":""}`}))};function E(e,t){return{mkPoint:e,geometryProps:t}}const L=document.getElementById("no-layer-msg").style;function M(e,t=l.j[e],n=g.layers[e]){Object(r.d)(t,I[n.mode].geometryProps(n))}function k(e,t){for(let n=e;n<=t;n+=1){const e=l.h.children[n];e.dataset.layerId=n,l.j[n].dataset.layerId=n,e.children[0].textContent=g.layers[n].label||"Layer "+(n+1),e.children[1].value=n}}function B(e,t=g.layers[e].style){Object(r.d)(l.j[e],t)}const S=({x:e,y:t})=>({x:e,y:t}),$=(e,t)=>({cx:e,cy:t}),P=e=>({cx:e}),N=(e,t)=>({cy:t}),T={M:1,L:1,H:1,V:1,Q:2,C:3,A:1,S:2,T:1},A=(e,t)=>e.points.slice(0,t).reduce((e,t)=>e+T[t.cmd],0),R=(e,t)=>{const n=[];if(e.points[t+1]){const{cmd:r}=e.points[t+1];"V"===r?n.push(D(l.d[A(e,t+1)],P)):"H"===r&&n.push(D(l.d[A(e,t+1)],N))}return n};var q={regularPoint:z(S,(e,t,n)=>{const r=R(t,n);return[D(e,$),...r]}),hCmd:z(({x:e})=>({x:e}),(e,t,n)=>{const r=R(t,n);return[D(e,P),...r]}),vCmd:z(({y:e})=>({y:e}),(e,t,n)=>{const r=R(t,n);return[D(e,N),...r]}),firstControlPoint:z(({x:e,y:t})=>({x1:e,y1:t}),e=>[D(e,$)]),secondControlPoint:z(({x:e,y:t})=>({x2:e,y2:t}),e=>[D(e,$)]),rectTopLeft:z(S,(e,t,n)=>{const r=t.points[n];return[D(e,$),D(l.d[1],(e,t)=>({cx:e+r.width,cy:t+r.height}))]}),rectLowerRight:z(({x:e,y:t},n)=>({width:e>n.x?e-n.x:n.width,height:t>n.y?t-n.y:n.height}),(e,t,n)=>{const r=t.points[n];return[D(e,(e,t)=>({cx:e<r.x?r.x:e,cy:t<r.y?r.y:t}))]}),ellipseCenter:z(({x:e,y:t})=>({cx:e,cy:t}),(e,t,n)=>{const r=t.points[n];return[D(e,$),D(l.d[1],()=>({cx:r.cx-r.rx,cy:r.cy})),D(l.d[2],()=>({cx:r.cx,cy:r.cy-r.ry}))]}),rx:z(({x:e},t)=>({rx:Math.abs(e-t.cx)}),e=>[D(e,P)]),ry:z(({y:e},t)=>({ry:Math.abs(e-t.cy)}),e=>[D(e,N)])};function z(e,t){return{changeData:e,getAffectedPoints:t}}function D(e,t){return{ref:e,fx:t}}const{regularPoint:H,hCmd:V,vCmd:_,firstControlPoint:Q,secondControlPoint:U,rectTopLeft:K,rectLowerRight:Y,ellipseCenter:G,rx:J,ry:X}=q,Z=()=>{Object.assign(l.q,{onpointermove:null,onpointerleave:null,onpointerup:null}),j()},F=(e,t,n)=>r=>{r.stopPropagation(),Object.assign(l.q,{onpointermove:re(e,t,n,r.target),onpointerleave:Z,onpointerup:Z})};function W(e){l.d[Object(r.j)(l.d)].remove(),["Q","C","S"].includes(e)&&l.d[Object(r.j)(l.d)].remove(),"C"===e&&l.d[Object(r.j)(l.d)].remove()}function ee(){[...l.d].forEach(e=>e.remove())}function te(e,t){return(n,r)=>{const o=[];"cmd"in n?(["Q","C","S"].includes(n.cmd)&&o.push(ne(n.x1,n.y1,r,Q,t)),"C"===n.cmd&&o.push(ne(n.x2,n.y2,r,U,t)),["M","L","Q","C","A","S","T"].includes(n.cmd)?o.push(ne(n.x,n.y,r,H,t)):"H"===n.cmd?o.push(ne(n.x,e.points[r-1].y,r,V,t)):"V"===n.cmd&&o.push(ne(e.points[r-1].x,n.y,r,_,t))):"width"in n?o.push(ne(n.x,n.y,r,K,t),ne(n.x+n.width,n.y+n.height,r,Y,t)):"cx"in n&&o.push(ne(n.cx,n.cy,r,G,t),ne(n.cx-n.rx,n.cy,r,J,t),ne(n.cx,n.cy-n.ry,r,X,t)),l.c.append(...o)}}function ne(e,t,n,o,c){return Object(r.c)(i)({cx:e,cy:t,onpointerdown:F(c,n,o),onpointerup:Z})}function re(e,t,n,o){const c=g.layers[e],a=c.points[t],{changeData:i}=n,s=n.getAffectedPoints(o,c,t);return t=>{const[n,o]=Object(r.h)(t);Object.assign(a,i({x:n,y:o},a)),M(e),s.forEach(({ref:e,fx:t})=>Object(r.d)(e,t(n,o)))}}const oe=Object.keys(I),ce=de(e=>"boolean"==typeof e,()=>{}),ae={mode:de(e=>oe.includes(e),e=>{l.k.modes.value=e,document.body.dataset.mode=e}),cmd:de(e=>f.a.includes(e),e=>{l.b.value=e}),layerId:de(e=>+e>=0&&+e<=g.layers.length,e=>{const t=te(ie.activeLayer,e);ee(),g.layers[e].points.forEach(t),l.m.checked=ie.activeLayer.closePath,Object(r.n)(g.layers[e].style),Object(r.l)(ie,f.c),Object(r.m)(ie),l.t.checked&&Object(r.p)(g.layers[e].transforms),Object(r.a)(g,ie)}),drawingShape:ce,reordering:ce,transformLayerNotDrawing:ce},ie=new Proxy({get activeLayer(){return g.layers[ie.layerId]},get transformTarget(){return ie.transformLayerNotDrawing?ie.activeLayer:g},cmd:"M",drawingShape:!1,reordering:!1,arcCmdConfig:{},shapeStart:{}},{set(e,t,n){const r=ae[t];return!(!r||!r.validate(n))&&(e[t]=n,r.onPass(n),!0)}});var se=ie;function de(e,t){return{validate:e,onPass:t}}const ue=u.getContext("2d"),le=e=>{Object.assign(s,{download:"My_SVG."+g.outputConfig["file-format"],href:e}),s.click()},fe=e=>window.navigator.clipboard.writeText(e);function ye(){const e=Object(r.g)(se.mode);var t,n,o;se.layerId=g.layers.push((t=se.mode,n={...f.c.style,...e},o=Object(r.b)(f.c.transforms),{mode:t,points:[],style:n,transforms:o}))-1,j();const c=Object(r.c)(a[se.mode])({"data-layer-id":se.layerId});l.f.append(c)}function me(){if(!se.activeLayer||!se.activeLayer.points.length)return;const e=se.activeLayer.points.pop();if(j(),e.cmd)W(e.cmd),M(se.layerId);else{const e=l.j[se.layerId],t=["data-layer-id","transform"];ee(),e.getAttributeNames().filter(e=>!t.includes(e)).forEach(t=>e.removeAttribute(t))}}new MutationObserver(function(e,t,n){const o=e=>{e.dataTransfer.setData("text",e.target.dataset.layerId),e.dataTransfer.effectAllowed="move"},a=({target:t})=>{e.activeLayer.label=t.textContent.replace(/\n/g,/\s/).trim(),j()},i=()=>{const t=l.h.childElementCount,n=c.cloneNode(!0),[i,s]=n.children;n.dataset.layerId=t,n.ondragstart=o,i.oninput=a,Object(r.d)(i,{textContent:g.layers[t]&&g.layers[t].label||"Layer "+(t+1)}),Object(r.d)(s,{value:t,checked:e.layerId===l.i.length}),l.h.append(n)},s=o=>{const c=+o.dataset.layerId;if(l.h.lastChild.remove(),!l.j.length)return delete e.layerId,t(),Object(r.p)(f.c.transforms),Object(r.a)(g,e),void Object(r.n)(f.c.style);if(e.layerId===l.j.length)e.layerId-=1;else{const o=n(e.activeLayer,e.layerId);e.mode=e.activeLayer.mode,t(),e.activeLayer.points.forEach(o),Object(r.n)(e.activeLayer.style),k(c,l.h.childElementCount-1)}l.i[e.layerId].checked=!0};return t=>{L.display=l.f.childElementCount?"none":"initial",e.reordering?e.reordering=!1:t.forEach(e=>{e.addedNodes.forEach(i),e.removedNodes.forEach(s)})}}(se,ee,te)).observe(l.f,{childList:!0}),l.a.oninput=function({target:e}){const t="checkbox"===e.type?"checked":"value";if(se.arcCmdConfig[e.name]=e[t],!se.activeLayer)return;const n=Object(r.f)(se.activeLayer.points);n&&(Object.assign(n,Object(O.a)({...f.c.arcCmdConfig,...se.arcCmdConfig})),M(se.layerId))},l.b.onchange=function({target:e}){se.cmd=f.a[f.a.indexOf(e.value)]||f.a[0]},document.getElementById("reset-transforms").onclick=function(){const{transforms:e}=f.c;l.t.checked&&se.activeLayer?se.activeLayer.transforms=Object(r.b)(e):g.transforms=Object(r.b)(e),Object(r.a)(g,se),Object(r.p)(e),j()},document.getElementById("get-markup").onclick=function(){fe(b())},document.getElementById("get-data-uri").onclick=function(){fe(v())},document.getElementById("center-rotation-btn").onclick=function(){!function(e,t){const{x:n,y:r,width:o,height:c}=e.getBBox(),a=[Math.trunc(n+.5*o),Math.trunc(r+.5*c)];[f.b.rotate[1].value,f.b.rotate[2].value]=a,[t.rotate[1],t.rotate[2]]=a,j()}(...se.transformLayerNotDrawing?[l.j[se.layerId],se.activeLayer.transforms]:[l.q.firstElementChild,g.transforms]),Object(r.a)(g,se)},document.getElementById("center-vb").onclick=p,document.getElementById("add-layer").onclick=ye,document.getElementById("del-layer").onclick=function(){l.j.length&&(g.layers.splice(se.layerId,1),l.j[se.layerId].remove())},document.getElementById("clear-all").onclick=function(){g.layers.length=0,g.outputConfig={...f.c.outputConfig},g.transforms=Object(r.b)(f.c.transforms),[...l.j].forEach(e=>e.remove()),j()},document.getElementById("undo").onclick=me,document.querySelector('a[data-tab-name="output"]').onclick=function(){l.n.innerHTML=b(),y.viewBox.every(e=>0===e)&&p()},l.e.onclick=function(){const e=v();"svg"===g.outputConfig["file-format"]?le(e):(d.src=e,d.onload=()=>{ue.clearRect(0,0,ue.canvas.width,ue.canvas.height),Object.assign(ue.canvas,{width:g.outputConfig.width,height:g.outputConfig.height}),ue.drawImage(d,0,0),le(u.toDataURL())})},l.g.oninput=function({target:e}){g.layers[se.layerId]&&(g.layers[se.layerId].style[e.name]=e.value,B(se.layerId))},l.h.onchange=function({target:{value:e}}){const t=+e;se.mode=g.layers[t].mode,se.layerId=t},l.h.ondrop=function(e){const t=+e.target.closest("label").dataset.layerId,n=l.j[t],r=+e.dataTransfer.getData("text"),o=l.j[r],[c]=g.layers.splice(r,1);g.layers.splice(t,0,c),j(),r<t?n.after(o):l.f.insertBefore(o,n),r!==se.layerId?r>se.layerId&&t<=se.layerId?se.layerId+=1:r<se.layerId&&t>se.layerId&&(se.layerId-=1):se.layerId=t,k(Math.min(r,t),Math.max(r,t)),l.i[se.layerId].checked=!0,se.reordering=!0,e.preventDefault()},l.k.onchange=function({target:e,currentTarget:t}){if(se.drawingShape)t.modes.value=se.mode;else if(se.mode=e.value,l.j[se.layerId])if(se.activeLayer.points.length)ye();else{se.activeLayer.mode=se.mode;const e=Object(r.c)(a[se.mode])({"data-layer-id":se.layerId}),t=l.j[se.layerId];t.replaceWith(e),t.remove(),Object.keys(se.activeLayer.style).forEach(e=>{void 0===f.c.style[e]&&delete se.activeLayer.style[e]}),Object.assign(se.activeLayer.style,Object(r.g)(se.mode)),j()}},l.l.oninput=function({target:e}){g.outputConfig[e.name]=e.value,x(),j()},l.m.onchange=function(){g.layers[se.layerId]&&(g.layers[se.layerId].closePath=l.m.checked,M(se.layerId))},l.q.addEventListener("pointerdown",(function(e){l.j.length||ye();const[t,n]=Object(r.h)(e),{points:o}=se.activeLayer;if(se.drawingShape){const e={hor:Math.abs(se.shapeStart.x-t),vert:Math.abs(se.shapeStart.y-n)},c="rect"===se.mode?{x:Math.min(se.shapeStart.x,t),y:Math.min(se.shapeStart.y,n),width:e.hor,height:e.vert}:{rx:e.hor,ry:e.vert};Object.assign(o[0],c),te(se.activeLayer,se.layerId)(Object(r.i)(o),Object(r.j)(o)),se.drawingShape=!1,l.q.onpointermove=null}else I[se.mode].mkPoint(se,o,t,n,te,W),"path"===se.mode&&l.c.lastElementChild.dispatchEvent(new Event("pointerdown"));B(se.layerId),M(se.layerId)})),l.r.oninput=function({target:e}){if(e.classList.contains("transform-config")){const{transform:t,id:n}=e.dataset;se.transformTarget.transforms[t][+n]=e.value}else se.transformTarget.transforms[e.name]=e.value;Object(r.a)(g,se),j()},l.t.onchange=function({target:{checked:e}}){e?Object(r.p)(se.activeLayer?se.activeLayer.transforms:f.c.transforms):Object(r.p)(g.transforms),se.transformLayerNotDrawing=e},window.addEventListener("DOMContentLoaded",(function(){const e=JSON.parse(window.localStorage.getItem("drawing"))||{};Object.assign(g,{outputConfig:e.outputConfig||{...f.c.outputConfig},transforms:e.transforms||Object(r.b)(f.c.transforms),layers:e.layers||[]}),se.mode=g.layers[0]&&g.layers[0].mode?g.layers[0].mode:f.c.mode,g.layers.length&&(se.layerId=0,l.m.checked=se.activeLayer.closePath),l.f.append(...g.layers.map((e,t)=>{const n=a[e.mode],o="path"===e.mode?{d:e.points.map(r.k).join(" ")+(e.closePath?"Z":"")}:e.points[0]||{},c={"data-layer-id":t,...e.style,...o,transform:Object(r.q)(e.transforms)};return Object(r.c)(n)(c)})),Object(r.a)(g,se),Object(r.p)(g.transforms||f.c.transforms),l.t.checked=!1,Object(r.l)(se,f.c),Object(r.o)(g)}),{once:!0}),window.onsubmit=e=>e.preventDefault(),window.onkeydown=function(e){if("#drawing"!==window.location.hash)return;const{key:t}=e;if("F12"===t)return;if("Enter"===t&&e.target.contentEditable&&e.target.blur(),document.activeElement!==document.body)return;const n=f.d[t];if(e.ctrlKey&&"C"===t.toUpperCase()){const e=Object(r.b)(se.activeLayer),t=l.j[se.layerId].cloneNode(!0);g.layers.splice(se.layerId,0,e),l.j[se.layerId].after(t),[...l.j].forEach((e,t)=>{e.dataset.layerId=t}),se.layerId+=1}else if(n){if(!se.activeLayer&&!e.ctrlKey)return;const{transforms:{translate:t}}=e.ctrlKey?g:se.activeLayer,{cb:o,prop:c}=n;t[c]=o(+t[c]),Object(r.a)(g,se)}else"Backspace"===t?me():f.a.includes(t.toUpperCase())&&(se.cmd=t.toUpperCase());e.preventDefault()}}]);