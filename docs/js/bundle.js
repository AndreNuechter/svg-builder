!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return i})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return d})),n.d(t,"g",(function(){return l})),n.d(t,"k",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m})),n.d(t,"m",(function(){return y})),n.d(t,"l",(function(){return g})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return h})),n.d(t,"p",(function(){return b})),n.d(t,"q",(function(){return O})),n.d(t,"r",(function(){return w})),n.d(t,"s",(function(){return v})),n.d(t,"t",(function(){return j})),n.d(t,"v",(function(){return x})),n.d(t,"u",(function(){return E})),n.d(t,"w",(function(){return C}));const r=document.getElementById("arc-cmd-config"),o=document.getElementById("commands"),c=document.getElementsByClassName("control-point"),a=document.getElementById("control-point-container"),i=document.getElementById("download-btn"),s=document.getElementById("drawing-content"),d=document.getElementById("fill-and-stroke"),{elements:l}=d,u=s.children,f=document.getElementById("layer-select"),m=document.getElementsByName("layer-selector"),y=document.getElementById("output-configuration"),g=document.getElementById("modes"),h=document.getElementById("preview"),p=document.getElementById("close-path-toggle"),b=document.getElementById("redo-btn"),v=document.getElementById("canvas"),x=document.getElementById("transformations"),j=x.elements,O=j.rotate.getElementsByTagName("input"),w=j.scale.getElementsByTagName("input"),[E]=document.getElementsByName("transform-layer-only"),C=document.getElementById("undo-btn")},function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return d})),n.d(t,"c",(function(){return s})),n.d(t,"e",(function(){return l})),n.d(t,"i",(function(){return y})),n.d(t,"j",(function(){return g})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"k",(function(){return h})),n.d(t,"l",(function(){return p}));var r=n(2),o=n(0);const c=["checked","textContent","data","onpointerdown","onpointerup"];function a(e,t){const n=p(e.transforms),r=[o.f,o.c],c=[n];if(t.activeSVGElement){const e=p(t.activeLayer.transforms);r.push(t.activeSVGElement),c.push(n+e,e)}else c.push(n);r.forEach((e,t)=>e.setAttribute("transform",c[t]))}function i(e){if("object"!=typeof e||null===e)return e;const t=Array.isArray(e)?[]:{};return Object.keys(e).forEach(n=>{t[n]=i(e[n])}),t}function s(e){return t=>d(e.cloneNode(!1),t)}function d(e,t){return Object.keys(t).forEach(n=>{c.includes(n)?e[n]=t[n]:e.setAttribute(n,t[n])}),e}function l(e,t){return n=>{const[r,o]=m(n);d(e,t(r,o))}}function u(e){return e.slice().reverse().find(e=>"A"===e.cmd)}function f(e){return[...o.g].filter(t=>t.hasAttribute("name")&&t.closest("label").classList.contains("for-"+e)).reduce((e,t)=>Object.assign(e,{[t.name]:t.value}),{})}function m({x:e,y:t}){let n=o.s.createSVGPoint();return Object.assign(n,{x:e,y:t}),n=n.matrixTransform(o.s.children[1].getScreenCTM().inverse()),[n.x,n.y]}function y(e){return e[g(e)]}function g(e){return e.length-1}function h(e){return e.cmd+r.c[e.cmd](e)}function p(e){return Object.entries(e).reduce((e,[t,n])=>`${e}${t}(${"object"==typeof n?n.filter(e=>""!==e):n})`,"")}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return d}));const r=({x:e,y:t})=>`${e} ${t}`,o={H:({x:e})=>e,V:({y:e})=>e,Q:({x:e,x1:t,y:n,y1:r})=>`${t} ${r} ${e} ${n}`,C:({x:e,x1:t,x2:n,y:r,y1:o,y2:c})=>`${t} ${o} ${n} ${c} ${e} ${r}`,A:({x:e,xR:t,xRot:n,y:r,yR:o,large:c,sweep:a})=>`${t} ${o} ${n} ${c} ${a} ${e} ${r}`,S:({x:e,x1:t,y:n,y1:r})=>`${t} ${r} ${e} ${n}`,T:r,M:r,L:r},c=(e,t,n,r)=>e<t?n>r?-33:33:0,a=(e,t,n,r)=>{const o=Math.abs(n-e),a=Math.abs(r-t);return{xMin:Math.min(e,n),yMin:Math.min(t,r),yOffset:c(a,o,n,e),xOffset:c(o,a,r,t)}};function i(e){return{xR:e.xR,yR:e.yR,xRot:e.xRot,large:+e.large,sweep:+e.sweep}}function s(e,t,{x:n,y:r}){const{xMin:o,yMin:c,yOffset:i,xOffset:s}=a(e,t,n,r);return{x1:o-s+.25*(Math.max(e,n)-o),y1:c-i+.25*(Math.max(t,r)-c),x2:o-s+.75*(Math.max(e,n)-o),y2:c-i+.75*(Math.max(t,r)-c)}}function d(e,t,{x:n,y:r}){const{xMin:o,yMin:c,yOffset:i,xOffset:s}=a(e,t,n,r);return{x1:o-s+.5*(Math.max(e,n)-o),y1:c-i+.5*(Math.max(t,r)-c)}}},function(e,t,n){"use strict";n.r(t),t.default=window.addEventListener("load",()=>{const e=({target:{parentElement:e}})=>{e.classList.toggle("closed"),e.classList.toggle("open")};[...document.getElementsByClassName("togglable")].forEach(t=>{t.firstElementChild.onclick=e,t.classList.contains("open")||t.classList.contains("closed")||t.classList.add("closed")})},{once:!0})},function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(0);const c=document.getElementById("coords"),a=e=>{const[t,n]=Object(r.h)(e);c.textContent=`x: ${Math.trunc(t)}, y: ${Math.trunc(n)}`,c.style.left=e.pageX-120+"px",c.style.top=e.pageY-40+"px"};t.default=(o.s.addEventListener("pointermove",a),void o.s.addEventListener("pointerleave",()=>{c.style=null}))},function(e,t,n){"use strict";n.r(t),t.default=(()=>{const{body:e}=document,t=document.getElementById("tabs"),n=[...t.children],r=["drawing","output"],o=()=>{const t=window.location.hash.slice(1),n=r.includes(t)?t:r[0];e.dataset.activeTab=n,document.querySelector(`a[data-tab-name="${n}"]`).click(),n!==t&&(window.location.hash=n)};window.addEventListener("DOMContentLoaded",o,{once:!0}),window.onhashchange=o,t.onclick=({target:t})=>{t.classList.contains("tab")&&(e.dataset.activeTab=t.dataset.tabName,n.forEach(e=>e.classList.remove("active")),t.classList.add("active"))}})()},function(e,t,n){n(7),n(4),n(3),e.exports=n(5)},function(e,t,n){"use strict";n.r(t);n(3),n(4),n(5);var r=n(1);const o="http://www.w3.org/2000/svg",c=(()=>{const e=Object(r.d)(document.createElement("label"),{draggable:!0}),t=Object(r.d)(document.createElement("span"),{contenteditable:!0}),n=Object(r.d)(document.createElement("input"),{type:"radio",name:"layer-selector"});return e.append(t,n),e})(),a={path:document.createElementNS(o,"path"),rect:document.createElementNS(o,"rect"),ellipse:document.createElementNS(o,"ellipse")},i=Object(r.d)(document.createElementNS(o,"circle"),{r:3,class:"control-point"}),s=document.createElement("a"),d=document.createElement("img"),l=document.createElement("canvas");var u=n(0),f=n(2);const m=Object.freeze(Object.keys(f.c)),y=Object.freeze({scale:u.r,rotate:u.q}),g=Object.freeze({mode:"path",closePath:!1,outputConfig:Object.freeze({width:"320",height:"180","vb-min-x":"0","vb-min-y":"0","vb-width":"0","vb-height":"0",ratio:"xMidYMid","slice-or-meet":"meet","file-format":"svg"}),transforms:Object.freeze({translate:Object.freeze([0,0]),scale:Object.freeze(["1","1"]),rotate:Object.freeze(["0","0","0"]),skewX:"0",skewY:"0"}),style:Object.freeze({stroke:"#000","stroke-opacity":"1","stroke-width":"2",fill:"none","fill-opacity":"1"}),arcCmdConfig:Object.freeze({xR:"50",yR:"50",xRot:"0",large:!1,sweep:!1})}),h=e=>e+1,p=e=>e-1,b=Object.freeze({ArrowUp:Object.freeze({prop:1,cb:p}),ArrowDown:Object.freeze({prop:1,cb:h}),ArrowLeft:Object.freeze({prop:0,cb:p}),ArrowRight:Object.freeze({prop:0,cb:h})}),{elements:v}=u.m,x=(e,t)=>{Object.entries(t).forEach(([t,n])=>{e[t].value=n})};function j(e){if("path"!==e.mode)return;const t=e.activeLayer&&Object(r.f)(e.activeLayer.points)||e.arcCmdConfig;Object.assign(e.arcCmdConfig,t),Object.entries(t).filter(([e])=>!["cmd","x","y"].includes(e)).forEach(([e,t])=>{const n=u.a.elements[e];n["checkbox"===n.type?"checked":"value"]=t})}function O(e){x(u.g,e)}function w({outputConfig:e}){x(v,e)}function E(e){Object.entries(e).filter(([e])=>"translate"!==e).forEach(([e,t])=>{y[e]?t.forEach((t,n)=>{y[e][n].value=t}):u.t[e].value=t})}window.onsubmit=e=>e.preventDefault();const C=/ data-layer-id="\d+"/g,L=/\s{2,}/g,I=JSON.parse(window.localStorage.getItem("drawing"))||{},k={outputConfig:I.outputConfig||{...g.outputConfig},transforms:I.transforms||Object(r.b)(g.transforms),layers:I.layers||[]},M=[Object(r.b)(k)],S=()=>window.localStorage.setItem("drawing",JSON.stringify(k));let B=0;var $=k;function P(){return[k.outputConfig["vb-min-x"],k.outputConfig["vb-min-y"],k.outputConfig["vb-width"],k.outputConfig["vb-height"]]}function N(){const{x:e,y:t,width:n,height:r}=u.f.getBBox();Object.assign(k.outputConfig,{"vb-min-x":Math.trunc(e).toString(),"vb-min-y":Math.trunc(t).toString(),"vb-width":Math.trunc(n).toString(),"vb-height":Math.trunc(r).toString()}),H(),w(k),R("centerVB")}function T(){return`<svg xmlns="http://www.w3.org/2000/svg" \n    width="${k.outputConfig.width}" \n    height="${k.outputConfig.height}" \n    viewBox="${P()}" \n    preserveAspectRatio="${k.outputConfig.ratio} ${k.outputConfig["slice-or-meet"]}">\n    <g transform="${Object(r.l)(k.transforms)}">${u.f.innerHTML}</g></svg>`.replace(C,"").replace(L," ")}function A(){return("data:image/svg+xml,"+T().replace(/"/g,"'")).replace(/#/g,"%23")}function R(e){!function(e){B<Object(r.j)(M)&&(M.length=B+1);M.push(e),B=Object(r.j)(M),z()}({layers:Object(r.b)(k.layers),transforms:Object(r.b)(k.transforms)}),console.log(e),S()}function V(){M.length>1&&B>0&&(B-=1,G(),z())}function D(){B<Object(r.j)(M)&&(B+=1,G(),z())}function z(){u.w.disabled=0===B,u.p.disabled=B===Object(r.j)(M)}function G(){const{layers:e,transforms:t}=M[B];Object.assign(k,{layers:Object(r.b)(e),transforms:Object(r.b)(t)}),S(),[...u.k].forEach(e=>e.remove()),document.dispatchEvent(new Event("resetCanvas"))}function H(){Object(r.d)(u.o.firstElementChild,{width:k.outputConfig.width,height:k.outputConfig.height,viewBox:P(),preserveAspectRatio:`${k.outputConfig.ratio} ${k.outputConfig["slice-or-meet"]}`})}const _=(e,t)=>(n,r)=>({x:Math.min(e,n),y:Math.min(t,r),width:Math.abs(e-n),height:Math.abs(t-r)}),Q=(e,t)=>(n,r)=>({rx:Math.abs(e-n),ry:Math.abs(t-r)});var U={rect:q((e,t,n,o)=>{if(t[0])return;const c=e.activeSVGElement;t.push({x:n,y:o}),Object(r.d)(c,t[0]),e.drawingShape=!0,Object.assign(e.shapeStart,{x:n,y:o}),u.s.onpointermove=Object(r.e)(c,_(n,o))},({points:[e]})=>({x:e.x,y:e.y,width:e.width||0,height:e.height||0})),ellipse:q((e,t,n,o)=>{if(t[0])return;const c=e.activeSVGElement;t.push({cx:n,cy:o}),Object(r.d)(c,t[0]),e.drawingShape=!0,Object.assign(e.shapeStart,{x:n,y:o}),u.s.onpointermove=Object(r.e)(c,Q(n,o))},({points:[e]})=>({cx:e.cx,cy:e.cy,rx:e.rx||0,ry:e.ry||0})),path:q((e,t,n,o,c,a)=>{const i=Object(r.i)(t);if(i&&n===i.x&&o===i.y)return;t.length||(e.cmd="M"),i&&i.cmd===e.cmd&&["M","V","H"].includes(e.cmd)&&a(t.pop().cmd),t.push({cmd:e.cmd,x:n,y:o});const s=(r=>{switch(r){case"Q":case"S":return Object(f.d)(n,o,t[t.length-2]);case"C":return Object(f.b)(n,o,t[t.length-2]);case"A":return Object(f.a)(e.arcCmdConfig);default:return{}}})(e.cmd);Object.assign(Object(r.i)(t),s),c(e.activeLayer,e.layerId)(Object(r.i)(t),Object(r.j)(t))},({points:e,closePath:t})=>({d:`${e.map(r.k).join("")} ${t?"Z":""}`}))};function q(e,t){return{mkPoint:e,geometryProps:t}}const Y=document.getElementById("no-layer-msg").style;function K(e,t=u.k[e],n=$.layers[e]){Object(r.d)(t,U[n.mode].geometryProps(n))}function Z(e,t){for(let n=e;n<=t;n+=1){const e=u.i.children[n],[t,r]=e.children;e.dataset.layerId=n,u.k[n].dataset.layerId=n,t.textContent=$.layers[n].label||"Layer "+(n+1),r.value=n}}function F(e,t=$.layers[e].style){Object(r.d)(u.k[e],t)}const J=({x:e,y:t})=>({x:e,y:t}),X=(e,t)=>({cx:e,cy:t}),W=e=>({cx:e}),ee=(e,t)=>({cy:t}),te={M:1,L:1,H:1,V:1,Q:2,C:3,A:1,S:2,T:1},ne=(e,t)=>e.points.slice(0,t).reduce((e,t)=>e+te[t.cmd],0),re=(e,t)=>{const n=[];if(e.points[t+1]){const{cmd:r}=e.points[t+1];"V"===r?n.push(ae(u.d[ne(e,t+1)],W)):"H"===r&&n.push(ae(u.d[ne(e,t+1)],ee))}return n};var oe={regularPoint:ce(J,(e,t,n)=>{const r=re(t,n);return[ae(e,X),...r]}),hCmd:ce(({x:e})=>({x:e}),(e,t,n)=>{const r=re(t,n);return[ae(e,W),...r]}),vCmd:ce(({y:e})=>({y:e}),(e,t,n)=>{const r=re(t,n);return[ae(e,ee),...r]}),firstControlPoint:ce(({x:e,y:t})=>({x1:e,y1:t}),e=>[ae(e,X)]),secondControlPoint:ce(({x:e,y:t})=>({x2:e,y2:t}),e=>[ae(e,X)]),rectTopLeft:ce(J,(e,t,n)=>{const r=t.points[n];return[ae(e,X),ae(u.d[1],(e,t)=>({cx:e+r.width,cy:t+r.height}))]}),rectLowerRight:ce(({x:e,y:t},n)=>({width:e>n.x?e-n.x:n.width,height:t>n.y?t-n.y:n.height}),(e,t,n)=>{const r=t.points[n];return[ae(e,(e,t)=>({cx:e<r.x?r.x:e,cy:t<r.y?r.y:t}))]}),ellipseCenter:ce(({x:e,y:t})=>({cx:e,cy:t}),(e,t,n)=>{const r=t.points[n];return[ae(e,X),ae(u.d[1],()=>({cx:r.cx-r.rx,cy:r.cy})),ae(u.d[2],()=>({cx:r.cx,cy:r.cy-r.ry}))]}),rx:ce(({x:e},t)=>({rx:Math.abs(e-t.cx)}),e=>[ae(e,W)]),ry:ce(({y:e},t)=>({ry:Math.abs(e-t.cy)}),e=>[ae(e,ee)])};function ce(e,t){return{changeData:e,getAffectedPoints:t}}function ae(e,t){return{ref:e,fx:t}}const{regularPoint:ie,hCmd:se,vCmd:de,firstControlPoint:le,secondControlPoint:ue,rectTopLeft:fe,rectLowerRight:me,ellipseCenter:ye,rx:ge,ry:he}=oe,pe=()=>{Object.assign(u.s,{onpointermove:null,onpointerleave:null,onpointerup:null}),R("dragging")},be=(e,t,n)=>r=>{r.stopPropagation(),Object.assign(u.s,{onpointermove:we(e,t,n,r.target),onpointerleave:pe,onpointerup:pe})};function ve(e){u.d[Object(r.j)(u.d)].remove(),["Q","C","S"].includes(e)&&u.d[Object(r.j)(u.d)].remove(),"C"===e&&u.d[Object(r.j)(u.d)].remove()}function xe(){[...u.d].forEach(e=>e.remove())}function je(e,t){return(n,r)=>{const o=[];"cmd"in n?(["Q","C","S"].includes(n.cmd)&&o.push(Oe(n.x1,n.y1,r,le,t)),"C"===n.cmd&&o.push(Oe(n.x2,n.y2,r,ue,t)),["M","L","Q","C","A","S","T"].includes(n.cmd)?o.push(Oe(n.x,n.y,r,ie,t)):"H"===n.cmd?o.push(Oe(n.x,e.points[r-1].y,r,se,t)):"V"===n.cmd&&o.push(Oe(e.points[r-1].x,n.y,r,de,t))):"width"in n?o.push(Oe(n.x,n.y,r,fe,t),Oe(n.x+n.width,n.y+n.height,r,me,t)):"cx"in n&&o.push(Oe(n.cx,n.cy,r,ye,t),Oe(n.cx-n.rx,n.cy,r,ge,t),Oe(n.cx,n.cy-n.ry,r,he,t)),u.c.append(...o)}}function Oe(e,t,n,o,c){return Object(r.c)(i)({cx:e,cy:t,onpointerdown:be(c,n,o)})}function we(e,t,n,o){const c=$.layers[e],a=c.points[t],{changeData:i}=n,s=n.getAffectedPoints(o,c,t);return t=>{const[n,o]=Object(r.h)(t);Object.assign(a,i({x:n,y:o},a)),K(e),s.forEach(({ref:e,fx:t})=>Object(r.d)(e,t(n,o)))}}const Ee=Object.keys(U),Ce=Me(e=>"boolean"==typeof e,()=>{}),Le={mode:Me(e=>Ee.includes(e),e=>{u.l.modes.value=e,document.body.dataset.mode=e}),cmd:Me(e=>m.includes(e),e=>{u.b.value=e}),layerId:Me(e=>+e>=0&&+e<$.layers.length,e=>{const t=je(Ie.activeLayer,e);var n;xe(),$.layers[e].points.forEach(t),u.n.checked=Ie.activeLayer.closePath,O($.layers[e].style),j(Ie),"path"===(n=Ie).activeLayer.mode&&(n.cmd=n.activeLayer.points.length?Object(r.i)(n.activeLayer.points).cmd:"M"),u.u.checked&&E($.layers[e].transforms),Object(r.a)($,Ie)}),drawingShape:Ce,reordering:Ce,transformLayerNotDrawing:Ce},Ie=new Proxy({get activeLayer(){return $.layers[Ie.layerId]},get activeSVGElement(){return u.k[Ie.layerId]},get transformTarget(){return Ie.transformLayerNotDrawing?Ie.activeLayer:$},cmd:"M",transformLayerNotDrawing:!1,drawingShape:!1,reordering:!1,arcCmdConfig:{...g.arcCmdConfig},shapeStart:{}},{set(e,t,n){const r=Le[t];return!(!r||!r.validate(n))&&(e[t]=n,r.onPass(n),!0)}});$.layers.length&&(Ie.layerId=0),Ie.mode=$.layers[0]&&$.layers[0].mode||g.mode,document.addEventListener("resetCanvas",Se),window.addEventListener("DOMContentLoaded",()=>{Se(),z()},{once:!0});var ke=Ie;function Me(e,t){return{validate:e,onPass:t}}function Se(){u.f.append(...$.layers.map((e,t)=>{const n=a[e.mode],o="path"===e.mode?{d:e.points.map(r.k).join(" ")+(e.closePath?"Z":"")}:e.points[0]||{},c={"data-layer-id":t,...e.style,...o,transform:Object(r.l)(e.transforms)};return Object(r.c)(n)(c)})),Object(r.a)($,Ie),E($.transforms),u.u.checked=Ie.transformLayerNotDrawing,j(Ie),w($)}const Be=["data-layer-id","transform"],$e=l.getContext("2d"),Pe=e=>{Object.assign(s,{download:"My_SVG."+$.outputConfig["file-format"],href:e}),s.click()},Ne=e=>window.navigator.clipboard.writeText(e),Te={C:Ve,Z:V,Y:D};function Ae(){const e=Object(r.g)(ke.mode);var t,n,o;$.layers.push((t=ke.mode,n={...g.style,...e},o=Object(r.b)(g.transforms),Object.assign(Object.create(null),{mode:t,points:[],style:n,transforms:o}))),ke.layerId=Object(r.j)($.layers);const c=Object(r.c)(a[ke.mode])({"data-layer-id":ke.layerId});u.f.append(c)}function Re(){if(!ke.activeLayer||!ke.activeLayer.points.length)return;const e=ke.activeLayer.points.pop();if(R("deleteLastPoint"),e.cmd)ve(e.cmd),K(ke.layerId);else{const e=ke.activeSVGElement;xe(),e.getAttributeNames().filter(e=>!Be.includes(e)).forEach(t=>e.removeAttribute(t))}}function Ve(){const e=Object(r.b)(ke.activeLayer),t=ke.activeSVGElement.cloneNode(!0);$.layers.splice(ke.layerId,0,e),ke.activeSVGElement.after(t),[...u.k].forEach((e,t)=>{e.dataset.layerId=t}),ke.layerId+=1,R("ctrl+c")}window.onkeyup=({key:e})=>{b[e]&&R("keyup")},u.v.onchange=()=>R("setTransform"),u.h.onchange=()=>R("setFillOrStroke"),new MutationObserver(function(e,t,n){const o=e=>{e.dataTransfer.setData("text",e.target.dataset.layerId),e.dataTransfer.effectAllowed="move"},a=({target:t})=>{e.activeLayer.label=t.textContent.replace(/\n/g,/\s/).trim(),R("changeLabel")},i=()=>{const t=u.i.childElementCount,n=c.cloneNode(!0),[i,s]=n.children;n.dataset.layerId=t,n.ondragstart=o,i.oninput=a,Object(r.d)(i,{textContent:$.layers[t]&&$.layers[t].label||"Layer "+(t+1)}),Object(r.d)(s,{value:t,checked:e.layerId===u.j.length}),u.i.append(n)},s=()=>u.i.lastChild.remove();return o=>{if(Y.display=u.f.childElementCount?"none":"initial",e.reordering)e.reordering=!1;else if(o.forEach(({addedNodes:e,removedNodes:t})=>{t.forEach(s),e.forEach(i)}),o.find(({removedNodes:e})=>e.length)){if(t(),u.k.length)if(e.layerId===u.k.length)e.layerId-=1;else{void 0===e.layerId&&(e.layerId=0);const t=n(e.activeLayer,e.layerId);O(e.activeLayer.style),Z(0,u.i.childElementCount-1),e.activeLayer.points.forEach(t),e.mode=e.activeLayer.mode}else delete e.layerId,O(g.style),E(g.transforms),u.f.setAttribute("transform",Object(r.l)(g.transforms));u.j[e.layerId]&&(u.j[e.layerId].checked=!0)}}}(ke,xe,je)).observe(u.f,{childList:!0}),u.a.oninput=function({target:e}){const t="checkbox"===e.type?"checked":"value";if(ke.arcCmdConfig[e.name]=e[t],!ke.activeLayer)return;const n=Object(r.f)(ke.activeLayer.points);n&&(Object.assign(n,Object(f.a)(ke.arcCmdConfig)),K(ke.layerId),R("configArcCmd"))},u.b.onchange=function({target:e}){ke.cmd=m[m.indexOf(e.value)]||m[0]},document.getElementById("reset-transforms").onclick=function(){const{transforms:e}=g;u.u.checked&&ke.activeLayer?ke.activeLayer.transforms=Object(r.b)(e):$.transforms=Object(r.b)(e),Object(r.a)($,ke),E(e),R("resetTransforms")},document.getElementById("get-markup").onclick=function(){Ne(T())},document.getElementById("get-data-uri").onclick=function(){Ne(A())},document.getElementById("center-rotation-btn").onclick=function(){!function(e,t){const{x:n,y:r,width:o,height:c}=e.getBBox(),a=[Math.trunc(n+.5*o),Math.trunc(r+.5*c)];[y.rotate[1].value,y.rotate[2].value]=a,[t.rotate[1],t.rotate[2]]=a,R("setCenterofRotation")}(...ke.transformLayerNotDrawing?[ke.activeSVGElement,ke.activeLayer.transforms]:[u.s.firstElementChild,$.transforms]),Object(r.a)($,ke)},document.getElementById("center-vb").onclick=N,document.getElementById("add-layer").onclick=Ae,document.getElementById("del-layer").onclick=function(){u.k.length&&($.layers.splice(ke.layerId,1),ke.activeSVGElement.remove(),R("deleteLayer"))},document.getElementById("clear-all").onclick=function(){$.layers.length=0,$.outputConfig={...g.outputConfig},$.transforms=Object(r.b)(g.transforms),[...u.k].forEach(e=>e.remove()),R("clear")},document.getElementById("del-last-point").onclick=Re,document.getElementById("duplicate-layer").onclick=Ve,document.querySelector('a[data-tab-name="output"]').onclick=function(){u.o.innerHTML=T(),P().every(e=>0===e)&&N()},u.e.onclick=function(){const e=A();"svg"===$.outputConfig["file-format"]?Pe(e):(d.src=e,d.onload=()=>{$e.clearRect(0,0,$e.canvas.width,$e.canvas.height),Object.assign($e.canvas,{width:$.outputConfig.width,height:$.outputConfig.height}),$e.drawImage(d,0,0),Pe(l.toDataURL())})},u.h.oninput=function({target:{name:e,value:t}}){ke.activeLayer&&(ke.activeLayer.style[e]=t,F(ke.layerId))},u.i.onchange=function({target:{value:e}}){const t=+e;ke.mode=$.layers[t].mode,ke.layerId=t},u.i.ondrop=function(e){const t=+e.target.closest("label").dataset.layerId,n=u.k[t],r=+e.dataTransfer.getData("text"),o=u.k[r],[c]=$.layers.splice(r,1);$.layers.splice(t,0,c),R("reorderLayer"),r<t?n.after(o):u.f.insertBefore(o,n),r!==ke.layerId?r>ke.layerId&&t<=ke.layerId?ke.layerId+=1:r<ke.layerId&&t>ke.layerId&&(ke.layerId-=1):ke.layerId=t,Z(Math.min(r,t),Math.max(r,t)),u.j[ke.layerId].checked=!0,ke.reordering=!0,e.preventDefault()},u.l.onchange=function({target:e,currentTarget:t}){if(ke.drawingShape)t.modes.value=ke.mode;else if(ke.mode=e.value,ke.activeSVGElement)if(ke.activeLayer.points.length)Ae();else{ke.activeLayer.mode=ke.mode;const e=Object(r.c)(a[ke.mode])({"data-layer-id":ke.layerId}),t=ke.activeSVGElement;t.replaceWith(e),t.remove(),Object.keys(ke.activeLayer.style).forEach(e=>{void 0===g.style[e]&&delete ke.activeLayer.style[e]}),Object.assign(ke.activeLayer.style,Object(r.g)(ke.mode)),R("setMode")}},u.m.oninput=function({target:{name:e,value:t}}){$.outputConfig[e]=t,H(),R("configOutput")},u.n.onchange=function(){ke.activeLayer&&(ke.activeLayer.closePath=u.n.checked,K(ke.layerId),R("togglePathClosing"))},u.p.addEventListener("click",D),u.s.addEventListener("pointerdown",(function(e){u.k.length||Ae();const[t,n]=Object(r.h)(e),{points:o}=ke.activeLayer;if(ke.drawingShape){const e={hor:Math.abs(ke.shapeStart.x-t),vert:Math.abs(ke.shapeStart.y-n)},c="rect"===ke.mode?{x:Math.min(ke.shapeStart.x,t),y:Math.min(ke.shapeStart.y,n),width:e.hor,height:e.vert}:{rx:e.hor,ry:e.vert};Object.assign(o[0],c),R("drawShape"),je(ke.activeLayer,ke.layerId)(Object(r.i)(o),Object(r.j)(o)),ke.drawingShape=!1,u.s.onpointermove=null}else U[ke.mode].mkPoint(ke,o,t,n,je,ve),"path"===ke.mode&&u.c.lastElementChild.dispatchEvent(new Event("pointerdown"));F(ke.layerId),K(ke.layerId)})),u.v.oninput=function({target:{classList:e,dataset:t,name:n,value:o}}){if(e.contains("transform-config")){const{transform:e,id:n}=t;ke.transformTarget.transforms[e][+n]=o}else ke.transformTarget.transforms[n]=o;Object(r.a)($,ke)},u.u.onchange=function({target:{checked:e}}){E(e?ke.activeLayer?ke.activeLayer.transforms:g.transforms:$.transforms),ke.transformLayerNotDrawing=e},u.w.addEventListener("click",V),window.onkeydown=function(e){if("#drawing"!==window.location.hash)return;const{key:t}=e;if("F12"===t)return;if("Enter"===t&&e.target.contentEditable&&e.target.blur(),document.activeElement!==document.body)return;const n=b[t];if(e.ctrlKey&&Te[t.toUpperCase()])Te[t.toUpperCase()]();else if(n){if(!ke.activeLayer&&!e.ctrlKey)return;const{transforms:{translate:t}}=e.ctrlKey?$:ke.activeLayer,{cb:o,prop:c}=n;t[c]=o(+t[c]),Object(r.a)($,ke)}else"Backspace"===t?Re():m.includes(t.toUpperCase())&&(ke.cmd=t.toUpperCase());e.preventDefault()}}]);